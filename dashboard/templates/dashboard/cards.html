<div class="d-grid gap-3 h-100" style="grid-template-columns: 1fr 1fr 1fr;">

    <!-- COLUNA 1 -->
    <div class="d-flex flex-column gap-3">
        
        <!-- CELULA 1: HORA, DATA, CLIMA-->
        <div class="glass-panel p-3 text-center" style="border-left: 2px solid var(--neon-red);">
            <div id="relogio" class="display-3 fw-bold text-white num-mono lh-1">--:--</div>
            <div id="data-hoje" class="text-secondary text-capitalize mb-2">--</div>
            <div class="border-top border-light border-opacity-10 pt-2 d-flex justify-content-center align-items-center gap-2">
                {% if clima %}
                    <i class="bi bi-cloud-drizzle fs-5 text-info"></i>
                    <span class="fs-4 fw-bold num-mono text-info">{{ clima.temp }}Â°C</span>
                {% else %}
                    <small class="text-muted">Scanner Offline</small>
                {% endif %}
            </div>
        </div>

        <!-- CELULA 2: MONITORAMENTO DO SISTEMA -->
        <div class="glass-panel p-3 flex-grow-1 d-flex flex-column" style="border-left: 2px solid var(--neon-red);">
            <span class="label-tech mb-3">SISTEMA</span>
            
            <div class="row g-2 mb-3">
                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-cpu text-secondary fs-6"> CPU</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.cpu }}%</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.cpu > 95 %}bg-danger{% elif sistema.cpu > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.cpu }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-gpu-card text-secondary fs-6"> GPU</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.gpu.load }}%</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.gpu.load > 95 %}bg-danger{% elif sistema.gpu.load > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.gpu.load }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-memory text-secondary fs-6"> RAM</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.ram_percent }}%</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.ram_percent > 95 %}bg-danger{% elif sistema.ram_percent > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.ram_percent }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-fan text-secondary fs-6"> FAN</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.ram_percent }}rpm</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.ram_percent > 95 %}bg-danger{% elif sistema.ram_percent > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.ram_percent }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-device-ssd-fill text-secondary fs-6"> SSD (C:)</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.discos.0.percent }}%</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.discos.0.percent > 95 %}bg-danger{% elif sistema.discos.0.percent > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.discos.0.percent }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-device-hdd-fill text-secondary fs-6"> HDD (D:)</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.discos.1.percent }}%</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.discos.1.percent > 95 %}bg-danger{% elif sistema.discos.1.percent > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.discos.1.percent }}%"></div>
                        </div>
                    </div>
                </div>
                
                <span class="label-tech">Network</span>
                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-arrow-down-short text-secondary fs-6"> DOWNLOAD</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.rede.download_mbps }}Mpbs</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.rede.download_mbps > 95 %}bg-danger{% elif sistema.rede.download_mbps > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.rede.download_mbps }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="bg-black bg-opacity-25 p-2 rounded border border-secondary border-opacity-25">
                        <span class="label-tech bi bi-arrow-up-short text-secondary fs-6"> UPLOAD</span>
                        <div class="d-flex align-items-end justify-content-between">
                            <span class="fs-4 num-mono text-white">{{ sistema.rede.upload_mbps }}Mbps</span>
                        </div>
                        <div class="progress bg-dark mt-1" style="height: 4px;">
                            <div class="progress-bar {% if sistema.rede.upload_mbps > 95 %}bg-danger{% elif sistema.rede.upload_mbps > 75 %}bg-warning{% else %}bg-primary{% endif %}" style="width: {{ sistema.rede.upload_mbps }}%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex flex-column gap-3">
                
        <div class="glass-panel p-3" style="border-left: 2px solid var(--neon-red);">
            <span class="label-tech mb-2">Atalhos</span>
            <div class="d-grid gap-2" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
            
                
                <a href="https://web.whatsapp.com" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
                    <span>WhatsApp</span>
                </a>
                
                <a href="https://instagram.com" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg" alt="Instagram">
                    <span>Instagram</span>
                </a>
                
                <a href="https://mail.google.com" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Mail">
                    <span>Gmail</span>
                </a>
                
                <a href="https://trello.com/w/fgtdesign/home" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Antu_trello.svg/960px-Antu_trello.svg.png" alt="Trello">
                    <span>Trello</span>
                </a>

                <a href="https://play.hbomax.com/profile-picker" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/HBO_Max_%282025%29.svg/960px-HBO_Max_%282025%29.svg.png?20250515034114" alt="HBO Max" style="filter: brightness(0) invert(1);">
                    <span>HBO Max</span>
                </a>
                
                <a href="https://www.primevideo.com/region/na/storefront" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Amazon_Prime_Video_logo_%282024%29.svg/960px-Amazon_Prime_Video_logo_%282024%29.svg.png?20240816090318" alt="Amazon Prime" style="transform: scale(1.3);">
                    <span>Amazon Prime</span>
                </a>
                
                <a href="https://www.netflix.com/browse" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/f/ff/Netflix-new-icon.png" alt="Netflix">
                    <span>Netflix</span>
                </a>

                <a href="https://premiere.globo.com/agora" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Premiere_%282017%29_logo.png/960px-Premiere_%282017%29_logo.png?20250211222901" alt="Premiere">
                    <span>Premiere</span>
                </a>

                <a href="https://youtube.com" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/0/09/YouTube_full-color_icon_%282017%29.svg" alt="YouTube">
                    <span>YouTube</span>
                </a>

                <a href="https://chatgpt.com/" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/ChatGPT-Logo.svg/960px-ChatGPT-Logo.svg.png?20240214002031" alt="GPT" style="filter: invert(1);">
                    <span>GPT</span>
                </a>

                <a href="https://gemini.google.com/app?hl=pt-BR" target="_blank" class="btn-launch">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Google-gemini-icon.svg/960px-Google-gemini-icon.svg.png?20240826133250" alt="Gemini">
                    <span>Gemini</span>
                </a>
                

            </div>
        </div>
        
        <div class="glass-panel p-0 flex-grow-1 position-relative d-flex flex-column" style="border-left: 2px solid var(--neon-purple);">
            
            {% if spotify and spotify.tocando %}
                <div style="position: absolute; inset: 0; background: url('{{ spotify.capa }}') center/cover; filter: blur(20px) brightness(0.3); z-index: 0;"></div>
                
                <div class="p-4 d-flex flex-column h-100 position-relative" style="z-index: 1;">
                    <div class="text-center mt-3">
                        <img src="{{ spotify.capa }}" class="rounded shadow-lg border border-white border-opacity-25" style="width: 180px; height: 180px;">
                        <h4 class="mt-3 mb-0 text-white fw-bold text-truncate">{{ spotify.nome }}</h4>
                        <p class="text-white-50">{{ spotify.artista }}</p>
                    </div>

                    <div class="flex-grow-1 d-flex align-items-center">
                        <canvas id="audio-visualizer" class="w-100 rounded" style="height: 80px; background: rgba(0,0,0,0.2);"></canvas>
                    </div>

                    <div class="mt-auto">
                        <div class="progress bg-white bg-opacity-10 mb-3" style="height: 4px;">
                            <div class="progress-bar bg-success box-shadow-glow" style="width: {{ spotify.percent }}%"></div>
                        </div>

                        <div class="d-flex justify-content-center align-items-center gap-4 mb-3">
                            <button class="btn btn-outline-light rounded-circle border-0 fs-4" hx-get="/comando/prev" hx-swap="none"><i class="bi bi-skip-backward-fill"></i></button>
                            <button class="btn btn-light rounded-circle fs-2 shadow-lg" hx-get="/comando/play" hx-swap="none"><i class="bi bi-play-fill text-dark"></i></button>
                            <button class="btn btn-outline-light rounded-circle border-0 fs-4" hx-get="/comando/next" hx-swap="none"><i class="bi bi-skip-forward-fill"></i></button>
                        </div>
                        
                        <div class="d-flex align-items-center gap-2 bg-black bg-opacity-40 p-2 rounded-pill border border-white border-opacity-10 w-75 mx-auto">
                            <button class="btn btn-sm btn-link text-white p-0" hx-get="/comando/vol_down" hx-swap="none"><i class="bi bi-dash-lg"></i></button>
                            <div class="flex-grow-1 text-center small text-secondary">VOLUME PC</div>
                            <button class="btn btn-sm btn-link text-white p-0" hx-get="/comando/vol_up" hx-swap="none"><i class="bi bi-plus-lg"></i></button>
                            <button class="btn btn-sm btn-outline-secondary rounded-circle ms-2" onclick="alternarAudio()"><i id="btn-audio-icon" class="bi bi-play-fill"></i></button>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="d-flex flex-column align-items-center justify-content-center h-100 text-white-50">
                    <i class="bi bi-spotify" style="font-size: 5rem; opacity: 0.2;"></i>
                    <p class="mt-3 font-monospace">AGUARDANDO SPOTIFY...</p>
                    <div class="mt-5 w-75">
                         <canvas id="audio-visualizer" class="w-100 rounded" style="height: 60px; background: rgba(0,0,0,0.2);"></canvas>
                         <button class="btn btn-outline-light btn-sm w-100 mt-2" onclick="alternarAudio()">Ligar Visualizer (Microfone)</button>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="d-flex flex-column gap-3">
        
        <div class="glass-panel p-3 flex-grow-1 d-flex flex-column" style="border-left: 2px solid var(--neon-green);">
            <span class="label-tech text-success mb-2">Mission Log</span>
            
            <form hx-post="{% url 'adicionar_nota' %}" hx-target="#lista-notas-container" hx-on::after-request="this.reset()">
                {% csrf_token %}
                <div class="input-group mb-3">
                    <input type="text" name="texto" class="form-control bg-dark border-secondary text-white font-monospace" placeholder="Nova tarefa..." autocomplete="off">
                    <button class="btn btn-outline-success" type="submit"><i class="bi bi-plus-lg"></i></button>
                </div>
            </form>

            <div id="lista-notas-container" class="overflow-auto flex-grow-1 pe-2">
                {% include 'dashboard/partials/lista_notas.html' %}
            </div>
        </div>

        <div class="glass-panel p-3" style="border-left: 2px solid var(--neon-yellow); min-height: 250px;">
            <span class="label-tech text-warning mb-3">Market Watch</span>
            <div class="d-flex flex-column gap-2">
                {% for moeda in cryptos|slice:":6" %}
                <div class="d-flex align-items-center justify-content-between p-2 rounded bg-white bg-opacity-5 border border-white border-opacity-5">
                    <div class="d-flex align-items-center">
                        <img src="{{ moeda.image }}" width="24" class="rounded-circle me-2">
                        <div>
                            <span class="fw-bold d-block lh-1 small">{{ moeda.symbol|upper }}</span>
                            <small class="text-secondary" style="font-size: 0.65rem;">{{ moeda.name }}</small>
                        </div>
                    </div>
                    <div class="text-end">
                        <span class="d-block num-mono small">${{ moeda.current_price|floatformat:0 }}</span>
                        {% if moeda.price_change_percentage_24h > 0 %}
                            <small class="text-success num-mono">{{ moeda.price_change_percentage_24h|floatformat:1 }}%</small>
                        {% else %}
                            <small class="text-danger num-mono">{{ moeda.price_change_percentage_24h|floatformat:1 }}%</small>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

</div>